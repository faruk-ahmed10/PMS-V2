<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="laravelTinkerProject">
    <option name="lastCode" value="&lt;?php&#10;$sql = `&#10;DELIMITER //&#10;DROP PROCEDURE IF EXISTS get_balance_sheet_report;&#10;CREATE PROCEDURE get_balance_sheet_report (IN first_session VARCHAR(10), IN second_session VARCHAR(10), IN third_session VARCHAR(10), IN fourth_session VARCHAR(10), IN fifth_session VARCHAR(10))&#10;BEGIN&#10;&#10;    SET&#10;        @first_session = first_session;&#10;    SET&#10;        @second_session = second_session;&#10;    SET&#10;        @third_session = third_session;&#10;    SET&#10;        @fourth_session = fourth_session;&#10;    SET&#10;        @fifth_session = fifth_session;&#10;    PREPARE&#10;        stmt&#10;        FROM&#10;        '&#10;        SELECT&#10;            BST.description,&#10;            BST.dpp_amount,&#10;            BST.FirstReceived,&#10;            BST.SecondReceived,&#10;            BST.ThirdReceived,&#10;            BST.FourthReceived,&#10;            BST.FifthReceived,&#10;            BST.total_received,&#10;            BST.FirstExpenditure,&#10;            BST.SecondExpenditure,&#10;            BST.ThirdExpenditure,&#10;            BST.FourthExpenditure,&#10;            BST.FifthExpenditure,&#10;            BST.total_expenditure,&#10;            BST.total_received - BST.total_expenditure AS current_bal,&#10;            BST.dpp_amount - BST.total_received AS due_amount&#10;        FROM (&#10;                 SELECT&#10;                     *,&#10;                     bsc.FirstReceived + bsc.SecondReceived + bsc.ThirdReceived + bsc.FourthReceived + bsc.FifthReceived AS total_received,&#10;                     bsc.FirstExpenditure + bsc.SecondExpenditure + bsc.ThirdExpenditure + bsc.FourthExpenditure + bsc.FifthExpenditure AS total_expenditure&#10;                 FROM&#10;                     (&#10;                         SELECT&#10;                             *,&#10;                             IF(@first_session IS NOT NULL, bs.first_session_received, 0) AS FirstReceived,&#10;                             IF(@second_session IS NOT NULL, bs.second_session_received, 0) AS SecondReceived,&#10;                             IF(@third_session IS NOT NULL, bs.third_session_received, 0) AS ThirdReceived,&#10;                             IF(@fourth_session IS NOT NULL, bs.fourth_session_received, 0) AS FourthReceived,&#10;                             IF(@fifth_session IS NOT NULL, bs.fifth_session_received, 0) AS FifthReceived,&#10;&#10;                             IF(@first_session IS NOT NULL, bs.first_session_expenditure, 0) AS FirstExpenditure,&#10;                             IF(@second_session IS NOT NULL, bs.second_session_expenditure, 0) AS SecondExpenditure,&#10;                             IF(@third_session IS NOT NULL, bs.third_session_expenditure, 0) AS ThirdExpenditure,&#10;                             IF(@fourth_session IS NOT NULL, bs.fourth_session_expenditure, 0) AS FourthExpenditure,&#10;                             IF(@fifth_session IS NOT NULL, bs.fifth_session_expenditure, 0) AS FifthExpenditure,&#10;                             bs.section_id as _section_id,&#10;                             bs.session as _session&#10;                         FROM&#10;                             (&#10;                                 SELECT&#10;                                     t.description,&#10;                                     b.dpp_amount,&#10;                                     b.section_id,&#10;                                     b.session,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         amount,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS first_session_received,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         amount,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS second_session_received,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         amount,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS third_session_received,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         amount,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS fourth_session_received,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         amount,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS fifth_session_received,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         expenditure_up_to_date,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS first_session_expenditure,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         expenditure_up_to_date,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS second_session_expenditure,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         expenditure_up_to_date,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS third_session_expenditure,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         expenditure_up_to_date,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS fourth_session_expenditure,&#10;                                     SUM(&#10;                                             IF(&#10;                                                         SESSION = ?,&#10;                                                         expenditure_up_to_date,&#10;                                                         0&#10;                                                 )&#10;                                         ) AS fifth_session_expenditure&#10;                                 FROM&#10;                                     balance_sheets b&#10;                                         JOIN tasks t ON&#10;                                             t.id = b.fund_id&#10;                                 GROUP BY&#10;                                     fund_id&#10;                             ) bs&#10;                     ) bsc&#10;             ) AS BST&#10;        ';&#10;    EXECUTE&#10;        stmt USING @first_session,&#10;        @second_session,&#10;        @third_session,&#10;        @fourth_session,&#10;        @fifth_session,&#10;        @first_session,&#10;        @second_session,&#10;        @third_session,&#10;        @fourth_session,&#10;        @fifth_session;&#10;&#10;END; //&#10;`;&#10;&#10;&#10;\Illuminate\Support\Facades\DB::statement($sql);" />
  </component>
</project>